
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.4">
    
    
      
        <title>Citeproc - manubot</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.80dcb947.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="lightgreen">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-manubotciteciteproc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="manubot" class="md-header__button md-logo" aria-label="manubot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            manubot
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Citeproc
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/manubot/manubot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    manubot
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="manubot" class="md-nav__button md-logo" aria-label="manubot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    manubot
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/manubot/manubot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    manubot
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../LICENSE/" class="md-nav__link">
        License
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Manubot
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Manubot" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Manubot
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../command/" class="md-nav__link">
        Command
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../util/" class="md-nav__link">
        Util
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_4" type="checkbox" id="__nav_3_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_4">
          Ai Revision
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Ai Revision" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_4">
          <span class="md-nav__icon md-icon"></span>
          Ai Revision
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ai_revision/ai_revision_command/" class="md-nav__link">
        Ai Revision Command
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ai_revision/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_5" type="checkbox" id="__nav_3_1_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_5">
          Cite
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cite" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_5">
          <span class="md-nav__icon md-icon"></span>
          Cite
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arxiv/" class="md-nav__link">
        Arxiv
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../citations/" class="md-nav__link">
        Citations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cite_command/" class="md-nav__link">
        Cite Command
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../citekey/" class="md-nav__link">
        Citekey
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Citeproc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Citeproc
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_jsonschema_csl_validator" class="md-nav__link">
    get_jsonschema_csl_validator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove_jsonschema_errors" class="md-nav__link">
    remove_jsonschema_errors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../csl_item/" class="md-nav__link">
        Csl Item
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../curie/" class="md-nav__link">
        Curie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../doi/" class="md-nav__link">
        Doi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../handlers/" class="md-nav__link">
        Handlers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../isbn/" class="md-nav__link">
        Isbn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pubmed/" class="md-nav__link">
        Pubmed
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../unpaywall/" class="md-nav__link">
        Unpaywall
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../url/" class="md-nav__link">
        Url
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wikidata/" class="md-nav__link">
        Wikidata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../zotero/" class="md-nav__link">
        Zotero
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_5_17" type="checkbox" id="__nav_3_1_5_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_5_17">
          Tests
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tests" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_5_17">
          <span class="md-nav__icon md-icon"></span>
          Tests
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_arxiv/" class="md-nav__link">
        Test Arxiv
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_citations/" class="md-nav__link">
        Test Citations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_cite_command/" class="md-nav__link">
        Test Cite Command
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_citekey/" class="md-nav__link">
        Test Citekey
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_citekey_api/" class="md-nav__link">
        Test Citekey Api
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_citeproc/" class="md-nav__link">
        Test Citeproc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_csl_item/" class="md-nav__link">
        Test Csl Item
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_curie/" class="md-nav__link">
        Test Curie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_doi/" class="md-nav__link">
        Test Doi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_handlers/" class="md-nav__link">
        Test Handlers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_isbn/" class="md-nav__link">
        Test Isbn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_pubmed/" class="md-nav__link">
        Test Pubmed
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_unpaywall/" class="md-nav__link">
        Test Unpaywall
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_url/" class="md-nav__link">
        Test Url
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_wikidata/" class="md-nav__link">
        Test Wikidata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tests/test_zotero/" class="md-nav__link">
        Test Zotero
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6" type="checkbox" id="__nav_3_1_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_6">
          Pandoc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Pandoc" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_6">
          <span class="md-nav__icon md-icon"></span>
          Pandoc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pandoc/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pandoc/cite_filter/" class="md-nav__link">
        Cite Filter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pandoc/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pandoc/util/" class="md-nav__link">
        Util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_7" type="checkbox" id="__nav_3_1_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_7">
          Process
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Process" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_7">
          <span class="md-nav__icon md-icon"></span>
          Process
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/bibliography/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/ci/" class="md-nav__link">
        Ci
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/manuscript/" class="md-nav__link">
        Manuscript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/metadata/" class="md-nav__link">
        Metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/process_command/" class="md-nav__link">
        Process Command
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/requests_cache/" class="md-nav__link">
        Requests Cache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/util/" class="md-nav__link">
        Util
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_7_9" type="checkbox" id="__nav_3_1_7_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_7_9">
          Tests
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tests" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_7_9">
          <span class="md-nav__icon md-icon"></span>
          Tests
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/tests/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/tests/test_bibliography/" class="md-nav__link">
        Test Bibliography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/tests/test_ci/" class="md-nav__link">
        Test Ci
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/tests/test_metadata/" class="md-nav__link">
        Test Metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/tests/test_process_command/" class="md-nav__link">
        Test Process Command
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/tests/test_util/" class="md-nav__link">
        Test Util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_8" type="checkbox" id="__nav_3_1_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_8">
          Tests
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tests" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_8">
          <span class="md-nav__icon md-icon"></span>
          Tests
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/test_command/" class="md-nav__link">
        Test Command
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/test_imports/" class="md-nav__link">
        Test Imports
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/test_readme/" class="md-nav__link">
        Test Readme
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/test_util/" class="md-nav__link">
        Test Util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_9" type="checkbox" id="__nav_3_1_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_9">
          Webpage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Webpage" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_9">
          <span class="md-nav__icon md-icon"></span>
          Webpage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../webpage/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../webpage/webpage_command/" class="md-nav__link">
        Webpage Command
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_jsonschema_csl_validator" class="md-nav__link">
    get_jsonschema_csl_validator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove_jsonschema_errors" class="md-nav__link">
    remove_jsonschema_errors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/manubot/manubot/edit/main/reference/manubot/cite/citeproc.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="module-manubotciteciteproc">Module manubot.cite.citeproc</h1>
<p>Correct or validate CSL item schema.</p>
<p>Module naming: citeproc is the generic name for programs that produce
formatted bibliographies and citations based on the metadata of
the cited objects and the formatting instructions provided by
Citation Style Language (CSL) styles.
-- https://en.wikipedia.org/wiki/CiteProc</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Correct or validate CSL item schema.</span>

<span class="sd">Module naming: citeproc is the generic name for programs that produce</span>

<span class="sd">formatted bibliographies and citations based on the metadata of</span>

<span class="sd">the cited objects and the formatting instructions provided by</span>

<span class="sd">Citation Style Language (CSL) styles.</span>

<span class="sd">-- https://en.wikipedia.org/wiki/CiteProc</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">manubot.util</span><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="n">read_serialized_data</span>

<span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_jsonschema_csl_validator</span><span class="p">():</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    Return a jsonschema validator for the CSL Item JSON Schema</span>

<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="kn">import</span><span class="w"> </span><span class="nn">jsonschema</span>

<span class="w">    </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://github.com/citation-style-language/schema/raw/v1.0.2/schemas/input/csl-data.json&quot;</span>

<span class="w">    </span><span class="n">schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_serialized_data</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="w">    </span><span class="n">Validator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonschema</span><span class="o">.</span><span class="n">validators</span><span class="o">.</span><span class="n">validator_for</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

<span class="w">    </span><span class="n">Validator</span><span class="o">.</span><span class="n">check_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Validator</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">remove_jsonschema_errors</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">recurse_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    Remove fields in CSL Items that produce JSON Schema errors. Should errors</span>

<span class="s2">    be removed, but the JSON instance still fails to validate, recursively call</span>

<span class="s2">    remove_jsonschema_errors until the instance validates or the recursion</span>

<span class="s2">    depth limit is reached.</span>

<span class="s2">    Note that this method may not be work for all types of JSON Schema errors</span>

<span class="s2">    and users looking to adapt it for other applications should write</span>

<span class="s2">    task-specific tests to provide empirical evaluate that it works as</span>

<span class="s2">    intended.</span>

<span class="s2">    The default in_place=False creates a deepcopy of instance before pruning it,</span>

<span class="s2">    such that a new dictionary is returned and instance is not edited.</span>

<span class="s2">    Set in_place=True to edit instance in-place. The inital implementation of</span>

<span class="s2">    remove_jsonschema_errors always deepcopied instance, and it is possible deepcopying</span>

<span class="s2">    is important to prevent malfunction when encountering certain edge cases.</span>

<span class="s2">    Please report if you observe any in_place dependent behaviors.</span>

<span class="s2">    See also:</span>

<span class="s2">    https://github.com/Julian/jsonschema/issues/448</span>

<span class="s2">    https://stackoverflow.com/questions/44694835</span>

<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">validator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_jsonschema_csl_validator</span><span class="p">()</span>

<span class="w">    </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">list</span><span class="p">(</span><span class="n">validator</span><span class="o">.</span><span class="n">iter_errors</span><span class="p">(</span><span class="n">instance</span><span class="p">))</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">in_place</span><span class="p">:</span>

<span class="w">        </span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

<span class="w">    </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sorted</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span><span class="w"> </span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errors</span><span class="p">:</span>

<span class="w">        </span><span class="n">_remove_error</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">validator</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">recurse_depth</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">instance</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">remove_jsonschema_errors</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">recurse_depth</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">in_place</span><span class="o">=</span><span class="n">in_place</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_delete_elem</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">absolute_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    Helper function for remove_jsonschema_errors that deletes an element in the</span>

<span class="s2">    JSON-like input instance at the specified path. absolute_path is relative</span>

<span class="s2">    to the original validated instance for logging purposes. Defaults to path,</span>

<span class="s2">    if not specified. message is an optional string with additional error</span>

<span class="s2">    information to log.</span>

<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">absolute_path</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="p">:</span>

<span class="w">        </span><span class="n">absolute_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span>

<span class="w">    </span><span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>

<span class="w">        </span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>

<span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;_delete_elem deleting CSL element at: &quot;</span>

<span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">absolute_path</span><span class="p">))</span>

<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="o">*</span><span class="n">head</span><span class="p">,</span><span class="w"> </span><span class="n">tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span>

<span class="w">    </span><span class="k">try</span><span class="p">:</span>

<span class="w">        </span><span class="k">del</span><span class="w"> </span><span class="n">_deep_get</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">head</span><span class="p">)[</span><span class="n">tail</span><span class="p">]</span>

<span class="w">    </span><span class="k">except</span><span class="w"> </span><span class="n">KeyError</span><span class="p">:</span>

<span class="w">        </span><span class="k">pass</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_deep_get</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p">):</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    Descend path to return a deep element in the JSON object instance.</span>

<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">path</span><span class="p">:</span>

<span class="w">        </span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">instance</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">instance</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_remove_error</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">):</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    Remove a jsonschema ValidationError from the JSON-like instance.</span>

<span class="s2">    See ValidationError documentation at</span>

<span class="s2">    https://python-jsonschema.readthedocs.io/en/latest/errors/#jsonschema.exceptions.ValidationError</span>

<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">sub_errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">context</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">sub_errors</span><span class="p">:</span>

<span class="w">        </span><span class="c1"># already_removed_additional was neccessary to workaround</span>

<span class="w">        </span><span class="c1"># https://github.com/citation-style-language/schema/issues/154</span>

<span class="w">        </span><span class="n">already_removed_additional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">False</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">sub_error</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sub_errors</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">sub_error</span><span class="o">.</span><span class="n">validator</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">already_removed_additional</span><span class="p">:</span>

<span class="w">                    </span><span class="k">continue</span>

<span class="w">                </span><span class="n">already_removed_additional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">True</span>

<span class="w">            </span><span class="n">sub_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_deep_get</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

<span class="w">            </span><span class="n">_remove_error</span><span class="p">(</span><span class="n">sub_instance</span><span class="p">,</span><span class="w"> </span><span class="n">sub_error</span><span class="p">)</span>

<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">validator</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="n">extras</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">set</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">instance</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">set</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">])</span>

<span class="w">        </span><span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>

<span class="w">            </span><span class="n">error</span><span class="o">.</span><span class="n">message</span>

<span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Will now remove these </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">extras</span><span class="p">)</span><span class="si">}</span><span class="s2"> additional properties.&quot;</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">extras</span><span class="p">:</span>

<span class="w">            </span><span class="n">_delete_elem</span><span class="p">(</span>

<span class="w">                </span><span class="n">instance</span><span class="o">=</span><span class="n">instance</span><span class="p">,</span>

<span class="w">                </span><span class="n">path</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">[</span><span class="n">key</span><span class="p">],</span>

<span class="w">                </span><span class="n">absolute_path</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">absolute_path</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">[</span><span class="n">key</span><span class="p">],</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">validator</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;enum&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;minItems&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;maxItems&quot;</span><span class="p">}:</span>

<span class="w">        </span><span class="n">_delete_elem</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">absolute_path</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>

<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">validator</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;required&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>

<span class="w">            </span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>

<span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;required element missing at: &quot;</span>

<span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">absolute_path</span><span class="p">))</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="k">else</span><span class="p">:</span>

<span class="w">        </span><span class="k">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">validator</span><span class="si">}</span><span class="s2"> is not yet supported&quot;</span><span class="p">)</span>
</code></pre></div>

</details>
<h2 id="functions">Functions</h2>
<h3 id="get_jsonschema_csl_validator">get_jsonschema_csl_validator</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_jsonschema_csl_validator</span><span class="p">(</span>

<span class="p">)</span>
</code></pre></div>

<p>Return a jsonschema validator for the CSL Item JSON Schema</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_jsonschema_csl_validator</span><span class="p">():</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    Return a jsonschema validator for the CSL Item JSON Schema</span>

<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="kn">import</span><span class="w"> </span><span class="nn">jsonschema</span>

<span class="w">    </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://github.com/citation-style-language/schema/raw/v1.0.2/schemas/input/csl-data.json&quot;</span>

<span class="w">    </span><span class="n">schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_serialized_data</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="w">    </span><span class="n">Validator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonschema</span><span class="o">.</span><span class="n">validators</span><span class="o">.</span><span class="n">validator_for</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

<span class="w">    </span><span class="n">Validator</span><span class="o">.</span><span class="n">check_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Validator</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="remove_jsonschema_errors">remove_jsonschema_errors</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_jsonschema_errors</span><span class="p">(</span>
    <span class="n">instance</span><span class="p">,</span>
    <span class="n">recurse_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

<p>Remove fields in CSL Items that produce JSON Schema errors. Should errors</p>
<p>be removed, but the JSON instance still fails to validate, recursively call
remove_jsonschema_errors until the instance validates or the recursion
depth limit is reached.</p>
<p>Note that this method may not be work for all types of JSON Schema errors
and users looking to adapt it for other applications should write
task-specific tests to provide empirical evaluate that it works as
intended.</p>
<p>The default in_place=False creates a deepcopy of instance before pruning it,
such that a new dictionary is returned and instance is not edited.
Set in_place=True to edit instance in-place. The inital implementation of
remove_jsonschema_errors always deepcopied instance, and it is possible deepcopying
is important to prevent malfunction when encountering certain edge cases.
Please report if you observe any in_place dependent behaviors.</p>
<p>See also:
https://github.com/Julian/jsonschema/issues/448
https://stackoverflow.com/questions/44694835</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="nx">def</span><span class="w"> </span><span class="nx">remove_jsonschema_errors</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span><span class="w"> </span><span class="nx">recurse_depth</span><span class="p">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="nx">in_place</span><span class="p">=</span><span class="nx">False</span><span class="p">):</span>

<span class="w">    </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">    Remove fields in CSL Items that produce JSON Schema errors. Should errors</span>

<span class="s">    be removed, but the JSON instance still fails to validate, recursively call</span>

<span class="s">    remove_jsonschema_errors until the instance validates or the recursion</span>

<span class="s">    depth limit is reached.</span>

<span class="s">    Note that this method may not be work for all types of JSON Schema errors</span>

<span class="s">    and users looking to adapt it for other applications should write</span>

<span class="s">    task-specific tests to provide empirical evaluate that it works as</span>

<span class="s">    intended.</span>

<span class="s">    The default in_place=False creates a deepcopy of instance before pruning it,</span>

<span class="s">    such that a new dictionary is returned and instance is not edited.</span>

<span class="s">    Set in_place=True to edit instance in-place. The inital implementation of</span>

<span class="s">    remove_jsonschema_errors always deepcopied instance, and it is possible deepcopying</span>

<span class="s">    is important to prevent malfunction when encountering certain edge cases.</span>

<span class="s">    Please report if you observe any in_place dependent behaviors.</span>

<span class="s">    See also:</span>

<span class="s">    https://github.com/Julian/jsonschema/issues/448</span>

<span class="s">    https://stackoverflow.com/questions/44694835</span>

<span class="s">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="nx">validator</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">get_jsonschema_csl_validator</span><span class="p">()</span>

<span class="w">    </span><span class="nx">errors</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">list</span><span class="p">(</span><span class="nx">validator</span><span class="p">.</span><span class="nx">iter_errors</span><span class="p">(</span><span class="nx">instance</span><span class="p">))</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">in_place</span><span class="p">:</span>

<span class="w">        </span><span class="nx">instance</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">copy</span><span class="p">.</span><span class="nx">deepcopy</span><span class="p">(</span><span class="nx">instance</span><span class="p">)</span>

<span class="w">    </span><span class="nx">errors</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">sorted</span><span class="p">(</span><span class="nx">errors</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">=</span><span class="nx">lambda</span><span class="w"> </span><span class="nx">e</span><span class="p">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span><span class="w"> </span><span class="nx">reverse</span><span class="p">=</span><span class="nx">True</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">error</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">errors</span><span class="p">:</span>

<span class="w">        </span><span class="nx">_remove_error</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">validator</span><span class="p">.</span><span class="nx">is_valid</span><span class="p">(</span><span class="nx">instance</span><span class="p">)</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">recurse_depth</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">instance</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">remove_jsonschema_errors</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span><span class="w"> </span><span class="nx">recurse_depth</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">in_place</span><span class="p">=</span><span class="nx">in_place</span><span class="p">)</span>
</code></pre></div>

</details>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        
<footer class="md-footer">
    
      <nav class="md-footer__inner md-grid" aria-label="Footer">
        
          
          <a href="../citekey/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Citekey" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Previous
                </span>
                Citekey
              </div>
            </div>
          </a>
        
        
          
          <a href="../csl_item/" class="md-footer__link md-footer__link--next" aria-label="Next: Csl Item" rel="next">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Next
                </span>
                Csl Item
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
            
            Powered by
            <a href="http://timothycrosley.github.io/portray">portray.</a>
            You too can
            <a href="http://timothycrosley.github.io/portray">
              portray</a>
            your Python project well using automatic documentation.
          </div>
        
      </div>
    </div>
  </footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "search": "../../../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>